# Finolog Integration Setup

## –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é** –∏–∑ Finolog –≤ YNAB –¥–ª—è Epic Web3.

### –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
- ‚úÖ **Finolog ‚Üí YNAB**: –ù–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑ Finolog –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ YNAB
- ‚ùå **YNAB ‚Üí Finolog**: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤ YNAB, –ù–ï —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Finolog (Epic Web3)
- **–ë–∏–∑–Ω–µ—Å ID**: `47504`
- **–¢—Ä–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –≤–∞–ª—é—Ç–∞—Ö**:
  - RUB: Account ID `161752`
  - EUR: Account ID `168187`
  - USD: Account ID `161666`

### YNAB (Alex Personal Budget)
- **Budget ID**: `90024622-dd15-4ef9-bfad-4e555f5471ac`
- **Account for Epic Web3**: `5f0d008f-0104-4b0c-bf70-1e3bf516e315`
- **–í–∞–ª—é—Ç–∞**: EUR

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç

–í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ EUR –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ YNAB:

1. **EUR ‚Üí EUR**: –ü—Ä—è–º–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è (1:1)
2. **USD ‚Üí EUR**: –ß–µ—Ä–µ–∑ –∫—É—Ä—Å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `exchange_rates` (–ø–æ–ª–µ `eur_to_usd`)
3. **RUB ‚Üí EUR**: –ß–µ—Ä–µ–∑ –∫—É—Ä—Å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `exchange_rates` (–ø–æ–ª–µ `eur_to_rub`)

**–ü—Ä–∏–º–µ—Ä –∫—É—Ä—Å–æ–≤ –Ω–∞ —è–Ω–≤–∞—Ä—å 2026**:
- EUR/USD: 1.17
- EUR/RUB: 94.36

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–∏—Ç–µ API Token –æ—Ç Finolog

1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç Finolog
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

### 2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ .env

```bash
# Finolog API Token
# Get your token from Finolog settings
FINOLOG_API_TOKEN=your_finolog_token_here
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∞–∫–∫–∞—É–Ω—Ç–æ–≤

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `src/services/finologSync.ts` –∏ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```typescript
const EPIC_WEB3_CONFIG: FinologAccountConfig[] = [
  {
    finologBizId: 47504,
    finologAccountId: 161752,
    finologCurrency: 'RUB',
    ynabBudgetId: ALEX_PERSONAL_BUDGET_ID,
    ynabAccountId: EPIC_WEB3_ACCOUNT_IN_ALEX,
    ynabCurrency: 'EUR',
  },
  {
    finologBizId: 47504,
    finologAccountId: 168187,
    finologCurrency: 'EUR',
    ynabBudgetId: ALEX_PERSONAL_BUDGET_ID,
    ynabAccountId: EPIC_WEB3_ACCOUNT_IN_ALEX,
    ynabCurrency: 'EUR',
  },
  {
    finologBizId: 47504,
    finologAccountId: 161666,
    finologCurrency: 'USD',
    ynabBudgetId: ALEX_PERSONAL_BUDGET_ID,
    ynabAccountId: EPIC_WEB3_ACCOUNT_IN_ALEX,
    ynabCurrency: 'EUR',
  },
];
```

### 4. –î–æ–±–∞–≤—å—Ç–µ –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç –≤ Supabase

–î–ª—è RUB –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å—ã –≤ —Ç–∞–±–ª–∏—Ü—É `exchange_rates`:

```sql
-- –î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å EUR/RUB –Ω–∞ —è–Ω–≤–∞—Ä—å 2026
UPDATE exchange_rates 
SET eur_to_rub = 94.36 
WHERE month = '2026-01';
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### 1. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

–ö–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∏–∑ Finolog –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `import_id`:

```
FINOLOG:{accountId}:{transactionId}
```

**–ü—Ä–∏–º–µ—Ä**: `FINOLOG:161752:12345`

### 2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å—É–º–º

Finolog —Ö—Ä–∞–Ω–∏—Ç —Å—É–º–º—ã –≤ –∫–æ–ø–µ–π–∫–∞—Ö/—Ü–µ–Ω—Ç–∞—Ö (100.00 = 10000).
YNAB —Ö—Ä–∞–Ω–∏—Ç —Å—É–º–º—ã –≤ milliunits (100.00 = 100000).

**–ê–ª–≥–æ—Ä–∏—Ç–º –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏**:
1. Finolog value √ó 10 = YNAB milliunits
2. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç—ã —á–µ—Ä–µ–∑ exchange_rates
3. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∑–Ω–∞–∫–∞ (expense = –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ, income = –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ)

### 3. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ memo

```typescript
// –ï—Å–ª–∏ –µ—Å—Ç—å description:
"Original Description | Finolog Sync"

// –ï—Å–ª–∏ description –ø—É—Å—Ç–æ–µ:
"Finolog Sync"
```

### 4. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å —Ç–∞–∫–∏–º –∂–µ `import_id` –≤ YNAB
- –ï—Å–ª–∏ –¥–∞ ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å–æ–∑–¥–∞–µ—Ç

### 5. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ **—Å 1 —è–Ω–≤–∞—Ä—è 2026 –≥–æ–¥–∞** –∏ –ø–æ–∑–∂–µ (—Å–æ–≥–ª–∞—Å–Ω–æ `SYNC_START_DATE` –≤ `.env`).

## API Endpoints

### Finolog API

**Base URL**: `https://api.finolog.ru/v1`

**–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**:
```
GET /biz/{bizId}/transaction?status=regular&account_ids={accountId}&report_date_from={from}&report_date_to={to}
```

**–ó–∞–≥–æ–ª–æ–≤–∫–∏**:
```
Accept: */*
Api-Token: {your_token}
```

## –õ–æ–≥–∏

–í–æ –≤—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∏—Ç:

```
üîÑ Starting Finolog sync: Account 161752 (EUR) -> YNAB 5f0d008f-... (EUR)
üì• Found 15 Finolog transactions
üìù Creating YNAB transaction: 12345 (expense) - -100.00 EUR
‚úÖ Created YNAB transaction for Finolog TX 12345
‚úÖ Finolog sync completed for account 161752: Created 3, Skipped 12, Errors 0
```

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå "Finolog sync disabled - no API token configured"

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ `FINOLOG_API_TOKEN` –≤ `.env` —Ñ–∞–π–ª

### ‚ùå "Finolog sync disabled - no accounts configured"

**–†–µ—à–µ–Ω–∏–µ**: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `src/services/finologSync.ts`

### ‚ùå "EUR/RUB exchange rate not found for month 2026-01"

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ –∫—É—Ä—Å –≤ —Ç–∞–±–ª–∏—Ü—É `exchange_rates`:
```sql
UPDATE exchange_rates 
SET eur_to_rub = 94.36 
WHERE month = '2026-01';
```

### ‚ùå "Cannot convert currency for transaction"

**–ü—Ä–∏—á–∏–Ω–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫—É—Ä—Å –≤–∞–ª—é—Ç –Ω–∞ –Ω—É–∂–Ω—ã–π –º–µ—Å—è—Ü

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ –∫—É—Ä—Å—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Å—è—Ü–µ–≤, –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
```bash
npm run sync-once
```

### –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
```bash
npm start
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ API —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env` (–Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ Git)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `import_id` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ –û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏—Å–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ:
- –û—à–∏–±–æ–∫ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–∞–ª—é—Ç
- –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- API –æ—à–∏–±–æ–∫ Finolog

## Roadmap

–í–æ–∑–º–æ–∂–Ω—ã–µ –±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
- [ ] Webhook-based —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ polling
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
- [ ] Dashboard –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Finolog –±–∏–∑–Ω–µ—Å–æ–≤

