<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wallets - YNAB Sync</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <div id="wallets-page" class="page">
    <div class="dashboard">
      <header>
        <h1>ü™ô Wallets</h1>
        <div class="header-buttons">
          <button onclick="window.location.href='/'" class="rates-btn">‚Üê Back to Dashboard</button>
          <button id="logout-btn" class="logout-btn">Logout</button>
        </div>
      </header>

      <div class="linked-card">
        <div class="linked-header">
          <div>
            <h2>Zerion Wallet Mappings</h2>
            <p style="color: #666; font-size: 14px; margin-top: 5px;">Crypto wallets synced to YNAB via Zerion (Ethereum, Polygon, Solana, etc.)</p>
          </div>
          <button id="add-wallet-btn" class="sync-btn" onclick="openWalletModal()">+ Add Wallet</button>
        </div>

        <div id="wallets-loading" class="loading">Loading wallets...</div>
        <div id="wallets-error" class="error" style="display: none;"></div>

        <div id="wallets-table-container" style="display: none;">
          <table class="linked-table">
            <thead>
              <tr>
                <th>Wallet Address</th>
                <th>Name</th>
                <th>Budget</th>
                <th>Account</th>
                <th>Currency</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="wallets-tbody">
            </tbody>
          </table>
        </div>

        <div id="wallets-empty" class="empty-state" style="display: none;">
          <div class="empty-state-icon">ü™ô</div>
          <p>No wallets configured</p>
          <p style="font-size: 13px; margin-top: 10px;">Add crypto wallets to sync with YNAB via Zerion</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Edit Wallet Modal -->
  <div id="wallet-modal" class="modal" style="display: none;">
    <div class="modal-content modal-wide">
      <div class="modal-header">
        <h2 id="wallet-modal-title">Add Wallet</h2>
        <button class="modal-close" onclick="closeWalletModal()">&times;</button>
      </div>
      <form id="wallet-form">
        <input type="hidden" id="wallet-id">

        <div class="form-group">
          <label for="wallet-address">Wallet Address *</label>
          <input type="text" id="wallet-address" placeholder="0x... or Solana address" required>
        </div>

        <div class="form-group">
          <label for="wallet-name">Wallet Name</label>
          <input type="text" id="wallet-name" placeholder="e.g. Main ETH Wallet">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="wallet-budget">Budget *</label>
            <select id="wallet-budget" required onchange="loadAccountsForBudget()">
              <option value="">Select budget...</option>
            </select>
          </div>
          <div class="form-group">
            <label for="wallet-account">Account *</label>
            <select id="wallet-account" required>
              <option value="">Select account...</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="wallet-currency">Budget Currency</label>
            <select id="wallet-currency">
              <option value="USD">USD</option>
              <option value="EUR">EUR</option>
            </select>
          </div>
          <div class="form-group">
            <label for="wallet-active">
              <input type="checkbox" id="wallet-active" checked>
              Active
            </label>
          </div>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-secondary" onclick="closeWalletModal()">Cancel</button>
          <button type="submit" class="btn-primary">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="delete-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Confirm Delete</h2>
        <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
      </div>
      <p id="delete-message">Are you sure you want to delete this wallet?</p>
      <div class="modal-actions">
        <button class="btn-secondary" onclick="closeDeleteModal()">Cancel</button>
        <button id="confirm-delete-btn" class="btn-delete">Delete</button>
      </div>
    </div>
  </div>

  <script src="/wallets.js"></script>
</body>
</html>
